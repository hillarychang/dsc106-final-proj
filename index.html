<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Introduction to Sailing with Interactive Visualizaitons</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://d3js.org/topojson.v3.min.js"></script>
<style>
    body {
        background-color: antiquewhite;
    }
    
    .country {
            stroke: #000;
            stroke-width: 0.5px;
        }
    .legend {
        display: inline-block;
        vertical-align: middle;
        background-color: rgba(255, 255, 255, 0.8);
        border: 4px solid #ccc;
        padding: 10px;
    }
    .legend p {
    margin-top: 0;
    margin-bottom: 10px;
    font-size: 14px;
    text-align: center;
    }
    .map {
        justify-content: center;
    }
    .legend-item {
        display: inline-block;
        margin-bottom: 5px;
    }
    .container {
        display: flex;
        flex-wrap: wrap;
        justify-content: left;
        align-items: center;
        margin-top: 20px;
    }

    .box {
        border: 2px solid black;
        width: 287px;
        height: 287px;
        margin: 15px;
        position: relative;
    }

    .drop-box {
        border: 2px solid black;
        width: 150px; 
        height: 50px; 
        position: relative; 
        bottom: -10px; 
        left: 50%; 
        transform: translateX(-50%);
        text-align: center;
        line-height: 50px;
        font-size: 20px;
    }

    .term-box {
        border: 2px solid black;
        background-color: white;
        width: 150px;
        height: 50px;
        margin: 10px;
        position: relative;
        cursor: pointer;
        text-align: center;
        line-height: 50px;
        font-size: 20px;
    }

    .wide-box {
        width: 913px;
        height: 289px; 
        justify-content: center;
    }

    .row {
        display: flex;
        justify-content: space-between;
        width: 100%;
        margin-bottom: 100px; 
    }

    .row:last-child {
        margin-bottom: 0; 
    }
    #term-box {
        display: flex; 
        justify-content: center; 
        align-items: center; 
        flex-wrap: wrap; 
        padding: 10px; 
        background-color: #a4c2f4ff; 
        border-radius: 8px;
    }
    #top-row {
        display: flex; 
        justify-content: center; 
        align-items: center;
        padding-bottom: 80px;
        background-color: antiquewhite;
    }
    #middle-row {
        display: flex; 
        justify-content: center; 
        align-items: center;
        padding-bottom: 80px;
    }
    #bottom-row {
        display: flex; 
        justify-content: center; 
        align-items: center;
        padding-bottom: 80px;
    }

    ul {
        font-family: Arial, sans-serif;
        font-size: 16px; 
        color: #333; 
        line-height: 1.5;
    }

    ul li {
        margin-bottom: 10px; 
    }
    .tooltip {
        position: absolute;
        background: rgba(0, 0, 0, 0.75);
        color: white;
        padding: 5px;
        border-radius: 5px;
        pointer-events: none;
        opacity: 0;
        transition: opacity 0.2s;
    }
    .highlight {
        fill: yellow;
    }
</style>
</head>
<body>
    <h1>Popularity of Olympic Sailing Over Time</h1>
    <p>Sailing has been included in the Summer Olympics since 1896 (though those events, specifically, were cancelled due to weather) and have continued to grow as an event. At the 2024 Paris Olympics, there will be over 40 different sailing events with hundreds of competitors. Interested to see how sailing has grown as a sport over time? Use the slider below to see the changes in how many countries send a team and how many sailors each team has. The most from any team was 59 sailors from Norway in 1920.</p>
    <div style="display: inline-block; vertical-align: middle; justify-content: center;" >
        <label for="year">Select Year: </label>
        <input type="range" id="year" min="1908" max="2020" step="4" value="1908"/>
        <span id="selectedYear">1908</span>
    </div>
    <div class="legend">
        <p>Number of People Sent to The Olympics</p>
        <div class="legend-item"><span style="background-color:#f7fbff;">&nbsp;&nbsp;&nbsp;&nbsp;</span> 0</div>
        <div class="legend-item"><span style="background-color:#c6dbef;">&nbsp;&nbsp;&nbsp;&nbsp;</span> 5</div>
        <div class="legend-item"><span style="background-color:#6baed6;">&nbsp;&nbsp;&nbsp;&nbsp;</span> 10</div>
        <div class="legend-item"><span style="background-color:#2171b5;">&nbsp;&nbsp;&nbsp;&nbsp;</span> 15</div>
        <div class="legend-item"><span style="background-color:#08306b;">&nbsp;&nbsp;&nbsp;&nbsp;</span> 20+</div>
    </div>
    <div id="totalCompetitors">Total Competitors: 0</div>
    <div class ="map">
    <script>
        const width = 900;
        const height = 600;
        const svg = d3.select('body').append('svg').attr('width', width).attr('height', height);
        const projection = d3.geoMercator().scale(140).translate([width / 2, height / 1.4]);
        const path = d3.geoPath(projection);
        const g = svg.append('g');

        d3.json('https://cdn.jsdelivr.net/npm/world-atlas@2/countries-110m.json')
            .then(data => {
                const countries = topojson.feature(data, data.objects.countries);

                g.selectAll('path')
                    .data(countries.features)
                    .enter().append('path')
                    .attr('class', 'country')
                    .attr('d', path);

                
                d3.json('competitors.json')
                    .then(competitorsData => {
                        const colorScale = d3.scaleSequential(d3.interpolateBlues).domain([0, 25]);
                        function updateMap(year) {
                            let totalCompetitors =0;
                            g.selectAll('.country')
                                .attr('fill', d => {
                                    const countryName = d.properties.name;
                                    const competitors = competitorsData[year][countryName] || 0;
                                    totalCompetitors += competitors;
                                    return colorScale(competitors);
                                });
                            document.getElementById('selectedYear').innerText = year;
                            document.getElementById('totalCompetitors').innerText = `Total Competitors: ${totalCompetitors}`;
                        }
                        const slider = document.getElementById('year');
                        slider.addEventListener('input', function() {
                            const year = this.value;
                            updateMap(year);
                        });
                        updateMap(slider.value);
                    })
                    .catch(error => console.log(error));
            })
            .catch(error => console.log(error));
    </script>
    </div>
    <p>To be added: tooltips for each country with the exact number of competitors representing that country.</p>
    <p>If time allows: tooltip will include the names of each team's competitors. This will require a lot of extra data sourcing.</P>
    <h1>Parts of the Boat and Their Functions</h1>
    <p>Mouse over each gray part of the boat to learn that part's name and function! If you get lost, the part you're currently on will be highlighted in yellow.</p>
    <svg id="dinghyDiagram" height = "45%" width = "45%" viewbox="0 0 224.896 198.438">
        <text x="0" y="14.5" fill="black">Side View:</text>
        <text x="120" y="14.5" fill="black">Top View:</text>
        <rect id="stern"
        width="77.206581"
        height="31.162245"
        x="141.15488"
        y="157.94897"
        fill = "lightgray"
        stroke = "black" />
        <rect id="port"
        width="38.434708"
        height="66.723846"
        x="141.15488"
        y="91.225128"
        fill = "lightgray"
        stroke = "black" />
        <rect id="starboard"
        width="38.434715"
        height="66.723854"
        x="179.92674"
        y="91.225128"
        fill = "lightgray"
        stroke = "black" />
        <path id="bow"
        d="m 141.14257,91.155548 h 77.19797 c 0,0 -32.8207,-155.324104 -77.19797,0 z"
        fill = "lightgray"
        stroke = "black" />
        <rect id="mast"
        width="2.986515"
        height="143.0004"
        x="92.229683"
        y="7.7442203"
        fill = "lightgray"
        stroke = "black" />
        <rect id="boom"
        width="63.389854"
        height="2.6219482"
        x="28.730257"
        y="120.76959"
        fill = "lightgray"
        stroke = "black" />
        <path id="hull"
        d="m 20.866125,147.92063 115.188135,0.2697 c 0,0 -5.36719,14.83348 -19.40445,18.06987 -14.03727,3.2364 -88.352192,1.3485 -88.352192,1.3485 0,0 -12.385821,-1.88789 -7.431493,-19.68807 z"
        fill = "lightgray"
        stroke = "black" />
        <path id="rudder"
        d="m 19.782695,144.38606 -0.316404,37.11317 c 0,0 -6.802701,13.94006 -8.70113,7.06055 -1.8984279,-6.87952 -6.1698916,-15.20735 0.316405,-43.81164 v 0 z"
        fill = "lightgray"
        stroke = "black" />
        <rect id="tiller"
        width="24.837769"
        height="2.1724782"
        x="19.782696"
        y="144.38606"
        fill = "lightgray"
        stroke = "black" />
        <path id="centerboard"
        d="m 60.2825,168.21361 h 18.826078 c 0,0 1.42382,21.18166 -3.955057,27.15597 -5.378882,5.97432 -9.96675,-13.39694 -14.871021,-27.15597 z"
        fill = "lightgray"
        stroke = "black" />
        <path id="vang"
        d="m 92.192758,136.42084 -11.361517,-12.90725 -3.166189,-0.0748 14.523419,15.82165 z"
        fill = "lightgray"
        stroke = "black" />
        <path id="main-sheet"
        d="m 57.659801,123.38431 3.30725,24.52988 H 58.29991 l -3.520621,-24.52988 z"
        fill = "lightgray"
        stroke = "black" />
        <path id="jib"
        d="M 95.558337,45.696596 134.38836,147.63751 c 0,0 -35.169257,0 -34.662005,-4.69106 0.507255,-4.69108 -5.798962,-17.30457 -4.168018,-97.249854 z"
        fill = "lightgray"
        stroke = "black" />
        <path id="jib-sheet"
        d="m 99.92375,143.23222 -4.524195,4.85443 z"
        fill = "lightgray"
        stroke = "black" />
        <path id="main"
        d="m 29.427311,120.83746 62.776436,-0.0722 0.0028,-111.5058283 c 0,0 -37.022064,-0.8879495 -62.779231,111.5780083 z"
        fill = "lightgray"
        stroke = "black" />
    </svg>     
    <div id="tooltip" class="tooltip"></div>
        <script>
            const parts = {
                "hull" : {
                    name: "Hull",
                    description: "The body of the boat. Most parts attach here. Sailor also sits on the top of the hull, called the deck."
                },
                "bow" : {
                    name: "Bow",
                    description: "The front, pointy end of the boat."
                },
                "stern" : {
                    name: "Stern",
                    description: "The back, flat end of the boat."
                },
                "port" : {
                    name: "Port",
                    description: "When looking towards the bow, this is the left side of the boat. Remember: left and port both have four letters."
                },
                "starboard" : {
                    name: "Starboard",
                    description: "When looking towards the bow, this is the right side of the boat."
                },
                "centerboard" : {
                    name: "Centerboard",
                    description: "This blade-shaped part of the boat sticks deep into the water and helps keep the boat upright by providing resistance against the moving water."
                },
                "mast" : {
                    name: "Mast",
                    description: "The tall pole in the middle of the boat that holds the boom and the main sail. The vang connects to this too."
                },
                "boom" : {
                    name: "Boom",
                    description: "This pole is parallel to the top of the boat. It hold the main sail. Remember to duck your head when tacking or gybing or you'll understand why this is called the boom (hint: it's the sound it makes when it hits your head)."
                },
                "main" : {
                    name: "Main",
                    description: "The large, center sail. This is responsible for most of the speed of the boat."
                },
                "jib" : {
                    name: "Jib",
                    description: "The smaller sail towards the front of the boat. This is responsible for fine tuning the speed and direction of the boat."
                },
                "rudder" : {
                    name: "Rudder",
                    description: "This blade-shaped part of the boat sticks into the water and acts like the axels and wheels of a car- it is responsible for turning the boat when pushed by the tiller."
                },
                "tiller" : {
                    name: "Tiller",
                    description: "Acts like the sailor's steering wheel, allowing them to change the direction of the boat."
                },
                "main-sheet" : {
                    name: "Main Sheet",
                    description: "Allows the sailor to control the main sail, determining how fast the boat goes. Sheets are the terms for lines (ropes) that bring a sail in or out."
                },
                "vang" : {
                    name: "Vang",
                    description:"A type of control line (rope). This brings down the boom to smooth out any wrinkles in the mainsail."
                }
            }
            const boatsvg = document.getElementById('dinghyDiagram');
            const tooltip = document.getElementById('tooltip');
            boatsvg.addEventListener('mousemove', function(event) {
                const target = event.target;
                if (target.tagName ==='rect' || target.tagName === 'path') {
                    const part=parts[target.id];
                    if (part) {
                        target.classList.add('highlight');
                        tooltip.style.opacity = 1;
                        tooltip.style.left = event.pageX + 10 + 'px';
                tooltip.style.top = event.pageY + 10 + 'px';
                tooltip.innerHTML = `<strong>${part.name}</strong><br>${part.description}`;
                    }
                }
            });
            boatsvg.addEventListener('mouseout', function(event) {
                const target = event.target;
                if (target.tagName ==='rect' || target.tagName === 'path') {
                    target.classList.remove('highlight');
                    tooltip.style.opacity = 0;
                }
            });
        </script>
    <h1>Basic Racing Rules Matching Game: Match the rule based on the image presented</h1>
    <div>
        <p>Read a brief description of the rules below, then drag the rule label to the corresponding diagram. The green boat is the boat that is not breaking a rule and the red boat is breaking a rule. The dropbox will outline in red if you are incorrect and green if you are correct. In each image, the blue arrow indicates the wind direction, the black dash line indicates the boat's course, and the orange circle indicates a mark/buoy.</p>
        <b>Rule Descriptions:</b>
        <ul>
            <li><b>Rule 10:</b> On opposite tacks. Port keeps clear of starboard.</li>
            <li><b>Rule 11:</b> On the same tack, overlapped. Windward boat keeps clear of leeward boat.</li>
            <li><b>Rule 12:</b> On the same tack, not overlapped. Boat clear astern keeps clear of the boat ahead.</li>
            <li><b>Rule 13:</b> While tacking. Until the boat is on a close-hauled course after tacking, it must keep clear of other boats. (Rules 10-12 do not apply)</li>
            <li><b>Rule 14:</b> Avoid collisions.</li>
            <li><b>Rule 31:</b> Do not hit marks.</li>
        </ul>
    </div>

<div id="term-box" class="container">
    <div class="term-box" draggable="true" ondragstart="drag(event)">Rule 10</div>
    <div class="term-box" draggable="true" ondragstart="drag(event)">Rule 11</div>
    <div class="term-box" draggable="true" ondragstart="drag(event)">Rule 12</div>
    <div class="term-box" draggable="true" ondragstart="drag(event)">Rule 13</div>
    <div class="term-box" draggable="true" ondragstart="drag(event)">Rule 14</div>
    <div class="term-box" draggable="true" ondragstart="drag(event)">Rule 31</div>
</div>

<div id='top-row' class="container">
    <div class="box wide-box" ondrop="drop(event)" ondragover="allowDrop(event)">
        <img src="rule13.jpg" alt="Rule 13">
        <div id="drop-box4" class="drop-box" ondrop="drop(event)" ondragover="allowDrop(event)"  style="background-color: white;"></div>
    </div>
</div>

<div id='middle-row' class="container">
    <div class="box" ondrop="drop(event)" ondragover="allowDrop(event)">
        <img src="rule10.jpg" alt="Rule 10">
        <div id="drop-box1" class="drop-box" ondrop="drop(event)" ondragover="allowDrop(event)"  style="background-color: white;"></div>
    </div>
    <div class="box" ondrop="drop(event)" ondragover="allowDrop(event)">
        <img src="rule31.jpg" alt="Rule 31">
        <div id="drop-box6" class="drop-box" ondrop="drop(event)" ondragover="allowDrop(event)"  style="background-color: white;"></div>
    </div>
</div>

<div id='bottom-row' class="container">
    <div class="box" ondrop="drop(event)" ondragover="allowDrop(event)">
        <img src="rule11.jpg" alt="Rule 11">
        <div id="drop-box2" class="drop-box" ondrop="drop(event)" ondragover="allowDrop(event)"  style="background-color: white;"></div>
    </div>
    <div class="box" ondrop="drop(event)" ondragover="allowDrop(event)">
        <img src="rule12.jpg" alt="Rule 12">
        <div id="drop-box3" class="drop-box" ondrop="drop(event)" ondragover="allowDrop(event)"  style="background-color: white;"></div>
    </div>
    <div class="box" ondrop="drop(event)" ondragover="allowDrop(event)">
        <img src="rule14.jpg" alt="Rule 14">
        <div id="drop-box5" class="drop-box" ondrop="drop(event)" ondragover="allowDrop(event)"  style="background-color: white;"></div>
    </div>
</div>
<script>
    function allowDrop(event) {
        event.preventDefault();
    }

    function drag(event) {
        event.dataTransfer.setData("text", event.target.innerText);
    }

    function drop(event) {
        event.preventDefault();
        var data = event.dataTransfer.getData("text");
        var dropBox = event.target;
        if (dropBox.classList.contains('drop-box')) {
            dropBox.innerText = data;
            if (data === dropBox.parentNode.querySelector('img').alt) {
                dropBox.style.borderColor = 'green';
            } else {
                dropBox.style.borderColor = 'red';
            }
        } else if (dropBox.classList.contains('term-box')) {
            var termBox = document.getElementById('term-box');
            termBox.appendChild(event.target);
        }
    }

    document.addEventListener('DOMContentLoaded', function() {
        var termBox = document.getElementById('term-box');
        termBox.addEventListener('dragstart', function(event) {
            event.target.style.opacity = '0.4';
        });
        termBox.addEventListener('dragend', function(event) {
            event.target.style.opacity = '1';
        });
    });
</script>
<h1>Race Flags and Their Meanings</h1>
<p>To be Added: Similar drag and drop game with basic race flags</p>
<h1>Example Race Course</h1>
<p>To be Added: Animation of a simple w4 course.</p>
<p>If time permits: allow viewers to pick a boat, which will randomly complete a w4 course, abiding by all rules. Viewer will be shown their boat's course and final position.</p>
</body>
</html>